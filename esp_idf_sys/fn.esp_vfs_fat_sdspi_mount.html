<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="@brief Convenience function to get FAT filesystem on SD card registered in VFS"><title>esp_vfs_fat_sdspi_mount in esp_idf_sys - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-2fcac8296ac587d8.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="esp_idf_sys" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0-nightly (7820972f8 2023-06-10)" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../static.files/storage-62ce34ea385b278a.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-48600a9606eff342.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../esp_idf_sys/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../esp_idf_sys/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><div class="sidebar-elems"><h2><a href="index.html">In esp_idf_sys</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="index.html">esp_idf_sys</a>::<wbr><a class="fn" href="#">esp_vfs_fat_sdspi_mount</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/esp_idf_sys/home/runner/work/esp-idf-sys/esp-idf-sys/target/riscv32imc-esp-espidf/debug/build/esp-idf-sys-d0bd668f35bae45e/out/bindings.rs.html#41585-41591">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub unsafe extern &quot;C&quot; fn esp_vfs_fat_sdspi_mount(
    base_path: *const c_char,
    host_config_input: *const <a class="struct" href="struct.sdmmc_host_t.html" title="struct esp_idf_sys::sdmmc_host_t">sdmmc_host_t</a>,
    slot_config: *const <a class="struct" href="struct.sdspi_device_config_t.html" title="struct esp_idf_sys::sdspi_device_config_t">sdspi_device_config_t</a>,
    mount_config: *const <a class="struct" href="struct.esp_vfs_fat_mount_config_t.html" title="struct esp_idf_sys::esp_vfs_fat_mount_config_t">esp_vfs_fat_mount_config_t</a>,
    out_card: *mut *mut <a class="struct" href="struct.sdmmc_card_t.html" title="struct esp_idf_sys::sdmmc_card_t">sdmmc_card_t</a>
) -&gt; <a class="type" href="type.esp_err_t.html" title="type esp_idf_sys::esp_err_t">esp_err_t</a></code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>@brief Convenience function to get FAT filesystem on SD card registered in VFS</p>
<p>This is an all-in-one function which does the following:</p>
<ul>
<li>initializes an SPI Master device based on the SPI Master driver with configuration in
slot_config, and attach it to an initialized SPI bus.</li>
<li>initializes SD card with configuration in host_config_input</li>
<li>mounts FAT partition on SD card using FATFS library, with configuration in mount_config</li>
<li>registers FATFS library with VFS, with prefix given by base_prefix variable</li>
</ul>
<p>This function is intended to make example code more compact.
For real world applications, developers should implement the logic of
probing SD card, locating and mounting partition, and registering FATFS in VFS,
with proper error checking and handling of exceptional conditions.</p>
<p>@note This function try to attach the new SD SPI device to the bus specified in host_config.
Make sure the SPI bus specified in <code>host_config-&gt;slot</code> have been initialized by
<code>spi_bus_initialize()</code> before.</p>
<p>@param base_path     path where partition should be registered (e.g. “/sdcard”)
@param host_config_input Pointer to structure describing SDMMC host. This structure can be
initialized using SDSPI_HOST_DEFAULT() macro.
@param slot_config   Pointer to structure with slot configuration.
For SPI peripheral, pass a pointer to sdspi_device_config_t
structure initialized using SDSPI_DEVICE_CONFIG_DEFAULT().
@param mount_config  pointer to structure with extra parameters for mounting FATFS
@param[out] out_card If not NULL, pointer to the card information structure will be returned via
this argument. It is suggested to hold this handle and use it to unmount the card later if
needed. Otherwise it’s not suggested to use more than one card at the same time and unmount one
of them in your application.
@return
- ESP_OK on success
- ESP_ERR_INVALID_STATE if esp_vfs_fat_sdmmc_mount was already called
- ESP_ERR_NO_MEM if memory can not be allocated
- ESP_FAIL if partition can not be mounted
- other error codes from SDMMC or SPI drivers, SDMMC protocol, or FATFS drivers</p>
</div></details></section></div></main></body></html>